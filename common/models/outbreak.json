{
  "name": "outbreak",
  "base": "extendedPersistedModel",
  "idInjection": true,
  "options": {
    "validateUpsert": true
  },
  "properties": {
    "name": {
      "type": "string",
      "required": true
    },
    "description": {
      "type": "string"
    },
    "disease": {
      "type": "string",
      "required": true
    },
    "country": {
      "type": "string",
      "required": true
    },
    "active": {
      "type": "boolean",
      "default": false
    },
    "statDate": {
      "type": "date",
      "required": true
    },
    "endDate": {
      "type": "date"
    },
    "periodOfFollowup": {
      "type": "number",
      "required": true
    },
    "frequencyOfFollowUp": {
      "type": "number",
      "required": true
    },
    "numberFollowUpsDay": {
      "type": "number",
      "default": 1
    },
    "displayDateFormat": {
      "type": "string",
      "default": "yyyy-mm-dd"
    },
    "noDaysAmongContacts": {
      "type": "number",
      "required": true
    },
    "noDaysDaysInChains": {
      "type": "number",
      "required": true
    },
    "noDaysNotSeen": {
      "type": "number",
      "required": true
    },
    "noLessContacts": {
      "type": "number",
      "required": true
    },
    "highExposureDuration": {
      "type": "number",
      "required": true
    },
    "fieldsToDisplayNode": {
      "type": "array"
    },
    "colorContactNode": {
      "type": "string"
    },
    "colorCaseClassifications": {
      "type": "array"
    },
    "iconPeopleDied": {
      "type": "string"
    },
    "iconEvents": {
      "type": "string"
    },
    "caseInvestigationTemplate": {
      "type": "object",
      "required": true
    },
    "contactFollowUpTemplate": {
      "type": "object",
      "required": true
    },
    "labResultsTemplate": {
      "type": "object",
      "required": true
    },
    "caseClassification": {
      "type": "object",
      "required": true
    },
    "vaccinationStatus": {
      "type": "object",
      "required": true
    },
    "nutritionalStatus": {
      "type": "object",
      "required": true
    },
    "pregnancyInformation": {
      "type": "object",
      "required": true
    }
  },
  "indexes": {
    "name_index": {
      "name": 1
    },
    "disease_index": {
      "disease": 1
    },
    "active_index": {
      "active": 1
    },
    "startDate_index": {
      "startDate": 1
    }
  },
  "validations": [],
  "relations": {
    "cases": {
      "type": "hasMany",
      "model": "case",
      "foreignKey": "outbreakId"
    },
    "clusters": {
      "type": "hasMany",
      "model": "cluster",
      "foreignKey": "outbreakId"
    },
    "contacts": {
      "type": "hasMany",
      "model": "contact",
      "foreignKey": "outbreakId"
    },
    "events": {
      "type": "hasMany",
      "model": "event",
      "foreignKey": "outbreakId"
    }
  },
  "acls": [
    {
      "principalType": "ROLE",
      "principalId": "$everyone",
      "permission": "DENY"
    },
    {
      "principalType": "ROLE",
      "principalId": "read_outbreak",
      "permission": "ALLOW",
      "property": "find"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_outbreak",
      "permission": "ALLOW",
      "property": "create"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_outbreak",
      "permission": "ALLOW",
      "property": "patchAttributes"
    },
    {
      "principalType": "ROLE",
      "principalId": "read_outbreak",
      "permission": "ALLOW",
      "property": "findById"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_outbreak",
      "permission": "ALLOW",
      "property": "deleteById"
    },
    {
      "principalType": "ROLE",
      "principalId": "read_outbreak",
      "permission": "ALLOW",
      "property": "getAvailableDateFormats"
    },
    {
      "principalType": "ROLE",
      "principalId": "read_outbreak",
      "permission": "ALLOW",
      "property": "count"
    },
    {
      "principalType": "ROLE",
      "principalId": "read_case",
      "permission": "ALLOW",
      "property": "__get__cases"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_case",
      "permission": "ALLOW",
      "property": "__create__cases"
    },
    {
      "principalType": "ROLE",
      "principalId": "read_case",
      "permission": "ALLOW",
      "property": "__findById__cases"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_case",
      "permission": "ALLOW",
      "property": "__updateById__cases"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_own_case",
      "permission": "ALLOW",
      "property": "__updateById__cases"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_case",
      "permission": "ALLOW",
      "property": "__destroyById__cases"
    },
    {
      "principalType": "ROLE",
      "principalId": "write_own_case",
      "permission": "ALLOW",
      "property": "__destroyById__cases"
    }
  ],
  "methods": {
    "getAvailableDateFormats": {
      "accepts": [],
      "returns": [
        {
          "arg": "dateFormats",
          "type": ["string"],
          "description": "List of available date formats",
          "root": true,
          "required": true
        }
      ],
      "description": "Retrieve the list of available date formats.",
      "http": {
        "verb": "get",
        "path": "/available-date-formats"
      }
    }
  }
}
